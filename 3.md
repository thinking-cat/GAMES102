# 三次样条函数
## 力学解释
三次样条的形状最开始是通过力学方程来表示的，即伯努利-欧拉方程。
> 伯努利-欧拉方程  
> $M\(x\) = EIK\(k\)=EI\frac{y^{''}(x)}{(1+(y^{'}(x)^2))^{\frac{3}{2}}}$


其中 $EI$ 都是跟样条本身的材质有关，与变量 $x$ 无关，因此可以看成常数，而当样条不受力的时候，$M(x)=0$，因此可以得到  


但是很明显这个方程由于 $k(x)$ 是非线性的，并不方便通过矩阵的方式做线性变换，因此需要做出一个**小扰动假设**。
> 小扰动假设：当弯折角度不大于$ 45^\circ $时
> 因为 $y^{'} \ll 1$  
> $\(1+(y^{'}(x))^2\)^\frac{3}{2} \approx 1$   
> $M(x)=EIy^{''}(x)$  
同时，如果加入小扰动假设，那么弯矩的表达式会变成一个一次式（推导过程不必深究） 
> $M(x)=ax+b$  
那么联立上述两个加入**小扰动假设**的式子，可以发现$y(x)$是一个三次式。  
> $EIy^{''}(x)=ax+b$  
> $y(x)=a_0 + a_1x + a_2x^2 + a_3x_3$  


所以每两个控制点之间的曲线**可以**被**三次函数**表示。 


因为我们要求每一段样条被**三次函数**表示，所以会要求其 $\boldsymbol{C^2}$ 连续，此外，要求其 $\boldsymbol{C^2}$ 连续还有一个原因是为了解方程，对于 $n+1$ 个控制点，共需要 $n$ 个三次式，则一共有 $4n$ 个未知数，也就是说要有 $4n$ 个等式才能求解。  


对于$n+1$个控制点，去掉首位 $2$ 个点，有 $n-1$ 点，而这 $n-1$ 个点都被要求了 $C^2$ 连续，所以可以写出$3n-3$个等式  
> 每一个点可以列出三个等式，比如  
> $y_0(x_1)=y_1(x_1)$  
> $y_0^{'}(x_1)=y_1^{'}(x_1)$   
> $y_0^{''}(x_1)=y_1^{''}(x_1)$  
> 其中y的下标表示了这是第0段和第1段样条的表达式  
此外还可以通过$n+1$个控制点再写出$n+1$个式子，此时一共 $4n-2$ 个式子，还缺2个式子。  
> $y_0(x_0)=y_0,\, y_0(x_1)=y_1,\cdots$  
> 此处字母发生了混用，等式右侧的$y_i$表示了样条在二位平面的纵坐标的值。  


回想一下我们因为什么而缺少了2个等式——是因为我们在列每个点满足 $C^2$ 连续的等式的时候，没有考虑开头和结尾2个点，因此需要给这两个点在连续性上找2个等式。  


这里可以用2种方法来补充这少的2个式子：  
+ Hermite型插值多项式  
+ Lidstone型插值多项式  


> 这里以Hermite型为例，对于端点，比如说起始点 $x_0$ ，我们可以求出其右导数，而又已知起始点所在的曲线是一个三次函数曲线，则要求4个未知量，但是我们又知道这4个条件：$x_0$ 的右导数，$x_0$ 的位置与对应的 $y_0$ , $x_1$ 的导数， $x_1$ 的位置与对应的 $y_1$ ,那么这样就有了4个等式，自然就可以求4个未知量了。


---

---
上述一直在讨论的$C^n$连续许多并不实用，比如说这样一张图： 

![Geometry_Continuity](./images/Geometry_Continuity.png)  


很明显这是一条直线，那么直线一定是任意阶连续的，但如果我们对其进行如图中所示进行参数化，那么在分段点的位置（ $t=1$ ），他是 $C^1$ 不连续的！这在数学上是对的，但是在工程实践中是反直觉的，因此需要定义一种连续性，或者需要一种方法，使得我们能够所见即所得，让这条直线**变得**任意阶连续，这就是几何连续的由来。  


**几何连续**:假设 $\phi (t)(a\le t \le b)$ 是给定曲线，若存在一个参数变换 $t=\rho (s)(a_1 \le s \le b_1)$ ，使得 $\phi (\rho (s)) \in C^n\[a_1,b_1\]$ ，且 $\frac{d\phi(\rho(s))}{ds} \ne 0$ ，则称曲线 $\phi(t)(a \le t \le b)$ 为n阶几何连续曲线，记作:  
$\phi(t) \in G^n\[a,b\]$  


这里条件 $\frac{d\phi(\rho(s))}{ds} \ne 0$ 是为了保证曲线上无奇点，换句话说就是曲线是参数化的，再换一句话说就是想象曲线上有一个动点，一般的参数化曲线都代表了这个点的运动轨迹，如果1阶导数为0，那么这个点就不动了，曲线就画不出来了。  


必须一提的是，**几何连续**是曲线本身的**固有属性**,是与参数选取无关的，就像是常温常压下密度之于水一样，不管水的体积是多少，密度永远不变。